# Friend Store Pipeline üöÄ

This project demonstrates a CI/CD pipeline for deploying a Friend Store built with Python (Flask) and JavaScript (React).

### Table of Contents

-   ‚öôÔ∏è **Tech Stack**: Python, React, SQLite, SQLAlchemy, Flask, Chakra UI
-   ‚úÖ **Pipeline Features**:
    - Continuous Integration (CI): Automatically builds, tests, and packages the application.
    - Continuous Deployment (CD): Automates deployment to IIS and manages infrastructure with Ansible.
    - Static Code Analysis: Ensures code quality using SonarQube.
    - Docker Image Generation: Builds Docker images for consistent environment management.
-   üåê **Monitoring**:
    - Prometheus: Tracks server performance metrics.
    - Grafana: Visualizes metrics and sets up alerting rules.

### CI Pipeline

#### Key Features:
- Installs backend and frontend dependencies.
- Runs unit tests (if configured).
- Performs static code analysis with SonarQube.
- Builds React frontend and packages Flask backend.
- Publishes build artifacts and Docker images.

#### Trigger:
The pipeline is triggered by changes to the `develop` and `feature/*` branches.

#### CI Pipeline Steps:
1. **Install Dependencies**:
   - Backend: Installs Python dependencies from `requirements.txt`.
   - Frontend: Installs Node.js dependencies with `npm`.
2. **Build Outputs**:
   - Builds React frontend for production.
   - Packages Flask backend files for deployment.
3. **Static Code Analysis**:
   - Uses SonarQube to ensure code quality.
4. **Build and Push Docker Image**:
   - Builds a Docker image for the backend.
   - Pushes the image to a local or remote registry.

### CD Pipeline

#### Key Features:
- Deploys the backend to IIS.
- Automates IIS setup and file deployment using Ansible.
- Restarts IIS to apply changes.

#### Trigger:
The pipeline is triggered by changes to the `main` branch.

#### CD Pipeline Steps:
1. **Deploy to IIS**:
   - Downloads artifacts generated by the CI pipeline.
   - Copies backend files to `C:\inetpub\wwwroot\MyFlaskApp`.
   - Restarts IIS to apply changes.
2. **Ansible Deployment**:
   - Uses an Ansible playbook to deploy the application.
   - Handles IIS server configuration and deployment automation.

### Monitoring Setup

#### Prometheus:
- Monitors server performance (e.g., CPU, memory, disk usage).
- Requires a Windows Exporter on the IIS server for metric collection.

#### Grafana:
- Visualizes Prometheus metrics with customizable dashboards.
- Sets up alerting rules for resource thresholds.

### Run the App Locally

1. Clone the repository:
   ```bash
   git clone https://github.com/your-repo/friend-store
   ```

2. Follow the instructions in the CI/CD pipelines to set up and deploy the application.

3. For local testing:
   - Backend: Run `flask run`.
   - Frontend: Run `npm run dev` from the `frontend` directory.

4. Open your browser and go to `http://localhost:5000/` to view the app.

### Additional Resources
- Prometheus Setup: [Prometheus Documentation](https://prometheus.io/docs/)
- Grafana Setup: [Grafana Documentation](https://grafana.com/docs/)
- Ansible Playbooks: Check the `deploy_flask_iis.yml` file for IIS automation.
- Docker: [Docker Documentation](https://docs.docker.com/)
